## Playwright Automation Lesson: Navigating ADP RUN Onboarding

**Learning Objective:** Master navigating the ADP RUN Onboarding portal using Playwright, TypeScript, and Cucumber, focusing on interacting with shadow DOM elements and manipulating form fields.

**Real-World Scenario:** Imagine you are automating the process of onboarding a new employee in ADP RUN. This involves:

1. Logging into RUN Onboarding as an administrator.
2. Navigating to the "New Hire" section.
3. Filling out the employee's personal information (name, address, etc.)
4. Managing payment details and tax information
5. Submitting the onboarding information.

**Code Implementation:**

```typescript
// pages/onboarding.ts
import { Page } from 'playwright';

interface Employee {
  firstName: string;
  lastName: string;
  address: string;
}

export class OnboardingPage {
  private page: Page;

  constructor(page: Page) {
    this.page = page;
  }

  async login(username: string, password: string) {
    await this.page.fill('input[name="username"]', username);
    await this.page.fill('input[name="password"]', password);
    await this.page.click('button[type="submit"]');
  }

  async fillEmployeeDetails(employee: Employee) {
    await this.page.fill('input[name="firstName"]', employee.firstName);
    await this.page.fill('input[name="lastName"]', employee.lastName);
    await this.page.fill('textarea[name="address"]', employee.address);
  }

  // Accessing a shadow DOM element
  async selectPaymentOption(option: string) {
    const shadowRoot = await this.page.evaluate(() => {
      const element = document.querySelector('select[name="paymentType"]');
      return element.shadowRoot;
    });

    const optionElement = await shadowRoot.evaluate((option) => {
      return document.querySelector(`option[value="${option}"]`);
    }, option);

    await optionElement.click();
  }

  async submitOnboarding() {
    await this.page.click('button[type="submit"]');
  }
}
```

**Step-by-Step Execution:**

1. **Project Setup:** Ensure you have Playwright, TypeScript, and Cucumber set up. Refer to the Playwright documentation for installation instructions.
2. **Feature File:** Create a Cucumber feature file (e.g., `onboarding.feature`) to define your test scenarios. 
3. **Step Definitions:**

```typescript
// steps.ts
import { Given, Then, When } from '@cucumber/cucumber';
import { OnboardingPage } from '../pages/onboarding';

let onboardingPage: OnboardingPage;

Given('I am on the ADP RUN Onboarding page', async () => {
  onboardingPage = new OnboardingPage(browser.newPage());
  await onboardingPage.page.goto('https://www.adp.com/run-onboarding'); // Replace with actual URL
});

When('I login with credentials', async ({ username, password }) => {
  await onboardingPage.login(username, password);
});

When('I fill in employee details', async ({ firstName, lastName, address }) => {
  await onboardingPage.fillEmployeeDetails({ firstName, lastName, address });
});

When('I select payment option {string}', async (option) => {
  await onboardingPage.selectPaymentOption(option);
});

Then('I submit the onboarding process', async () => {
  await onboardingPage.submitOnboarding();
});
``` 
4. **Run Tests:** Execute your Cucumber tests using a command like `npx cucumber`.



**Pro Tips:**

* **Shadow DOM Handling:**
    * Use `page.evaluate` to access shadow DOM elements.
    * Employ selectors that target specific elements within the shadow root to ensure accurate manipulation.

* **Element Handling:**
    * Utilize Playwright's powerful `click`, `fill`, and `select` methods for interacting with elements.

* **Error Handling:**
    * Implement robust error handling using `try...catch` blocks to gracefully handle unexpected scenarios.



**Practice Challenge:**

Modify the code to:

1. Handle dynamic IDs for elements within the shadow DOM.
2. Extract verification messages from the page after submitting the onboarding process.

**Next Steps:**

* Dive deeper into Playwright's API for advanced interactions (e.g., keyboard events, file uploads).
* Explore Selenium-based solutions for compatibility with other browsers.
* Integrate your Playwright scripts into a CI/CD pipeline for continuous automation testing.


