

## Playwright Automation for ADP Systems: A Practical Lesson

Welcome, fellow automation enthusiast! Today, we'll dive into the exciting world of automating ADP systems using Playwright, a powerful open-source automation framework.

### 1. Learning Objective

By the end of this lesson, you'll be able to:

- Understand the basics of Playwright.
- Automate common tasks in ADP web interfaces using JavaScript.
- Handle dynamic elements and shadow DOMs.



### 2. Real-World Scenario

Imagine you're an ADP payroll specialist tasked with automating the process of adding a new employee to the system. Instead of manually navigating through multiple screens and inputting data, you can write a script to do it for you, saving time and reducing the risk of human error.

In this lesson, we'll simulate this scenario by automating the process of entering employee information into ADP RUN Onboarding.

### 3. Code Implementation

Here's a  basic example of a Playwright script for adding a new employee in ADP RUN Onboarding:

```javascript
const { chromium } = require('playwright');

async function addEmployee() {
  const browser = await chromium.launch({ headless: false }); // Launch Chrome browser
  const page = await browser.newPage();

  // Navigate to ADP RUN Onboarding login page
  await page.goto('https://login.adp.com/'); 

  // Login with your credentials
  await page.type('#username', 'your_username'); 
  await page.fill('#password', 'your_password');
  await page.click('#submit'); // Click the login button

  // Navigate to the onboarding section
  await page.goto('https://your-adp-run-onboarding-url'); // Replace with your actual URL

  // Locate and fill in employee details
  await page.type('#firstName', 'Jane'); 
  await page.type('#lastName', 'Doe'); 
  await page.type('#email', 'jane.doe@example.com');

  // ...(Add more fields and data as needed) ...

  // Submit the onboarding form
  await page.click('#submit-button'); // Click the submit button

  await browser.close();
}

addEmployee();
```

**Key takeaways from the code:**

- **Browser launching:** We launch a headless Chrome browser instance using `chromium.launch()`.
- **Navigation:** We use `page.goto()` to navigate to specific URLs.
- **Form input:**  `page.type()` and `page.fill()` are used to enter data into form fields.
- **Clicking elements:** `page.click()` is used to interact with buttons and links.
- **Waiting:**  This code lacks explicit waits. In a real scenario, you should add waits before interacting with elements to ensure they are fully loaded and ready.
- **Locators:**  These example uses basic element IDs, but you'll need to identify the correct locators for your target ADP system. 

### 4. Step-by-Step Execution

1. Make sure you have Node.js and npm installed.
2. Install Playwright: `npm install playwright`.
3. **Important**: Replace placeholders like `your_username`, `your_password`, `https://your-adp-run-onboarding-url` and `#submit-button` with your actual ADP credentials and selectors. 
4. Save the code as a `.js` file (e.g., `add_employee.js`).
5. Run the script: `node add_employee.js`

### 5. Pro Tips

- **Robust Locators:** Use a combination of locators (ID, class, XPath, CSS selector) to ensure your script remains stable when ADP updates its interface. Consider using libraries like `Playwright Selector` or `Puppeteer Selector` to help with this.
- **Handling Dynamic Content:**

Use Playwright's `waitForSelector()` and `expect()` methods to wait for dynamic elements to load before interacting with them.


- **Shadow DOM:** ADP systems often use Shadow DOM, which can be challenging to automate. Playwright offers several strategies for interacting with Shadow DOM elements, such as using the `shadowRoot` property or evaluating expressions within the shadow DOM.

### 6. Practice Challenge

- Write a Playwright script to:
    - Login to ADP RUN Onboarding.
    - Update an existing employee's contact information.
    - Download a specific employee's pay stub.

### 7. Next Steps

- Explore Playwright's advanced features like asynchronous programming, multiple browser support, and cross-platform testing.
- Automate more complex payroll workflows involving employee time tracking, benefits administration, and reporting.
- Consider integrating Playwright with other tools like CI/CD pipelines for continuous integration and delivery of your automated tests.


