## Lesson: Automating Employee Onboarding with Playwright & Shadow DOM

**Learning Objective:** Master using Playwright to automate employee onboarding workflows on ADP RUN Onboarding, specifically focusing on navigating shadow DOM elements and interacting with dynamically loaded content.

**Real-World Scenario:** 

You need to automate the process of creating a new employee profile within ADP RUN Onboarding. 

This involves:

* **Entering employee details:** Name, address, contact information, etc.
* **Navigating to specific sections:** Utilizing breadcrumb navigation within the shadow DOM.
* **Selecting options from dropdowns:** Handling dynamic options loaded asynchronously.
* **Uploading supporting documents:** Simulating file selection and upload.

**Code Implementation:** (JavaScript/Playwright)

```javascript
const { chromium } = require('playwright');

async function automateOnboarding() {
  const browser = await chromium.launch();
  const page = await browser.newPage();
  const url = 'https://runonboarding.adp.com'; // Replace with actual URL

  try {
    await page.goto(url);

    // Navigate to the employee details section (replace with actual selector)
    await page.click('//button[text="New Employee"]');

    // Fill in employee details using shadow DOM manipulation (replace placeholders)
    const shadowRoot = await page.$eval('#employeeDetailsPanel', el => el.shadowRoot);
    await shadowRoot.querySelector('input[name="name"]').fill('John Doe');
    await shadowRoot.querySelector('input[name="email"]').fill('john.doe@example.com');

    // Navigate to tax information section using breadcrumbs (replace selectors)
    await page.click('//a[text="Tax Information"]');

    // Select state from dropdown using async load handling (replace selectors)
    await page.waitForSelector('select[name="state"]');
    const dropdown = await page.$('select[name="state"]');
    const options = await dropdown.$$eval('option', elements => elements.map(element => element.text)); 
    await dropdown.selectOption('California');

    // Upload a resume - replace path with your file location
    await page.setInputFiles('input[type="file"]', 'path/to/resume.pdf');

    // Simulate clicking "Submit" button
    await page.click('button[type="submit"]');

    console.log('Onboarding process successfully automated!');
  } catch (error) {
    console.error('Error:', error);
  } finally {
    await browser.close();
  }
}

automateOnboarding();
```

**Step-by-Step Execution:**

1. **Install Playwright:** `npm install playwright`
2. **Download necessary browsers:** Follow Playwright's instructions to download the browser binaries: [https://playwright.dev/docs/setup](https://playwright.dev/docs/setup)
3. **Save the code:** Save the code as a `.js` file (e.g., `onboarding_automation.js`).
4. **Run the code:** `node onboarding_automation.js`

**Pro Tips:**

* **Shadow DOM:** Utilize `page.$eval` or `page.$$eval` to target elements within shadow DOMs.
* **Dynamic Elements:** Use `page.waitForSelector` with appropriate timeouts to ensure elements are loaded before interacting with them.
* **Data-Driven Automation:** Store employee details in a CSV or JSON file and dynamically populate the fields for reusability.
* **Page Objects:** Create reusable page objects to encapsulate interactions with specific pages, improving code maintainability.

**Practice Challenge:**

Modify the code to automate the process of adding a beneficiary to an employee profile within ADP RUN Onboarding. Remember to adjust selectors and handle any potential shadow DOM structures.

**Next Steps:**

Tomorrow, we'll explore advanced Playwright techniques such as:

* **Handling complex forms:** Dealing with multi-step forms and dynamic form fields.
* **Automating PDF downloads and manipulations:** Leveraging Playwrightâ€™s capabilities to work with PDF files.
* **Integrating with CI/CD pipelines:** Setting up automated testing and deployments for your payroll automation scripts.


